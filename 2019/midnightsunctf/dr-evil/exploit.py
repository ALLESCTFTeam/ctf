from scapy.all import *
import binascii

pcap = rdpcap('dr-evil.pcap')
res = []

for packet in pcap:
    if IP in packet and packet[IP].src == '52.15.194.28':
        res.append(packet[IP].flags == 'evil')

# print boolean array as ascii (extra 0 because the string did not have even length)
print(binascii.unhexlify('%x0' % int(''.join(map(lambda b: '1' if b else '0', res)), 2)).decode())
